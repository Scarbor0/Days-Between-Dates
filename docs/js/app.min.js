(()=>{"use strict";class t{constructor(t,e){if(this.$el=document.querySelector(t),this.startDate=e.startDate,this.endDate=e.endDate,this.includingFirstDay=e.includingFirstDay,this.includingLastDay=e.includingLastDay,"current"!==this.endDate){const t=this.endDate.split(".");this.liveD=Number(t[0]),this.liveM=Number(t[1]),this.liveY=Number(t[2])}else this.liveY=(new Date).getFullYear(),this.liveM=(new Date).getMonth()+1,this.liveD=(new Date).getDate();this.arrMonths=[],this.clearArrM=[],this.arrMinusZeroM=[],this.lastD=0,this.firstD=0,this.calcDays=0,this.calcMonths=0,this.calcYear=0,this.daysAllCount(),this.editMStartEnd(),this.editDStartEnd(),this.countDMY()}startDateEnter(t){if(10!==this.startDate.length)return!1;switch(t){case"D":return this.startDate.split(".").map(Number)[0];case"M":return this.startDate.split(".").map(Number)[1];case"Y":return this.startDate.split(".").map(Number)[2]}}calendarGen(t){const e=[];for(let a=0;a<12;a++){const i=new Date(t,a+1,0).getDate();e.push(i)}return e}daysAllCount(){for(let t=this.startDateEnter("Y");t<=this.liveY;t++)this.arrMonths=this.arrMonths.concat(this.calendarGen(t));//! makes all the arrays of the calendar of years at one massif (all days of months at one massif)
}editMStartEnd(){let t=null;this.arrMonths=this.arrMonths.map((e=>(t+=1,t<this.startDateEnter("M")||t>this.arrMonths.length-12+this.liveM?0:(0!==e&&(this.clearArrM.push(e),this.arrMinusZeroM.push(e)),e)))),this.firstOriginM=this.clearArrM[0],this.lastOriginM=this.clearArrM[this.clearArrM.length-1]}editDStartEnd(){!0===this.includingLastDay?this.clearArrM[this.clearArrM.length-1]=this.liveD:this.clearArrM[this.clearArrM.length-1]=this.liveD-1,!0===this.includingFirstDay?this.clearArrM[0]=this.clearArrM[0]-this.startDateEnter("D")+1:this.clearArrM[0]=this.clearArrM[0]-this.startDateEnter("D"),this.lastD=this.clearArrM[this.clearArrM.length-1],this.firstD=this.clearArrM[0]}totalDays(){let t=null;return this.clearArrM.forEach((e=>{t+=e})),t}countDMY(){for(let t=0;t<=this.clearArrM.length-1;t++)this.clearArrM[t]===this.arrMinusZeroM[t]?this.calcMonths+=1:this.clearArrM[t]!==this.arrMinusZeroM[t]&&(this.calcDays+=this.clearArrM[t]);this.calcDays>=this.firstOriginM&&(this.calcDays-=this.firstOriginM,this.calcMonths+=1),this.calcMonths>=12&&(this.calcYear=Math.floor(this.calcMonths/12),this.calcMonths-=12*this.calcYear)}errorMessage(){if(this.startDateStr=`${this.startDateEnter("D")}.${this.startDateEnter("M")}.${this.startDateEnter("Y")}`,this.endDateStr=`${this.liveD}.${this.liveM}.${this.liveY}`,this.totalDays()<=0||isNaN(this.totalDays()))return!1}}let e=!1;window.addEventListener("load",(()=>{e=!0}));function a(t){if(!0===e&&null===document.querySelector(".content-here__wrapper")){const e=document.querySelector(t);e.innerHTML="",e.insertAdjacentHTML("beforeend",'\n\t\t\t<div class="content-here__wrapper">\n\t\t\t\t<span class="_icon-content content-here__icon"></span>\n\t\t\t</div>\n\t\t\t')}}function i(t,e){const a=document.querySelector(t);let i="";i="current"===e.endDate?e.curentData:e.endDate,!0===e.isError?(a.innerHTML="",a.insertAdjacentHTML("beforeend",`\n\t\t<div class="result-render-dbd error-blinking-result unselectable">\n\t\t\t<h4 class='tittle tittle-error tittle-result'>Помилка!!!</h4>\n\t\t\t<div class="dbd__column-result">\n\t\t\t\t<p class="error-result">${e.errorMessage}</p>\n\t\t\t</div>\n\t\t</div>\n\t\t`)):!1===e.isError&&(a.innerHTML="",a.insertAdjacentHTML("beforeend",`\n\t\t\t<div class="result-render-dbd">\n\t\t\t\t<h4 class="tittle dbd__tittle tittle-result">Результат</h4>\n\t\t\t\t<div class="dbd__table">\n\t\t\t\t\t<div class="dbd__title-result-wrapper">\n\t\t\t\t\t\t\t<div class="dbd__column-title">\n\t\t\t\t\t\t\t\t<p>Період&nbsp;${!0===e.includingFirstDay?"(включно)":""}:</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="dbd__column-result">\n\t\t\t\t\t\t\t\t<p>${e.starDate} - ${i}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="dbd__title-result-wrapper">\n\t\t\t\t\t\t<div class="dbd__column-title">\n\t\t\t\t\t\t\t<p>Інтервал:</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="dbd__column-result">\n\t\t\t\t\t\t\t<p>${e.years}р. ${e.months}міс. ${e.days}дн.</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="dbd__title-result-wrapper">\n\t\t\t\t\t\t<div class="dbd__column-title">\n\t\t\t\t\t\t\t<p>Календарних&nbsp;днів:</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="dbd__column-result">\n\t\t\t\t\t\t\t<p>${e.totalDays} дн.</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`))}a(".days-between-dates");const n=new class{constructor(t){this.$el=document.querySelectorAll(t),this.$dbdTextRender=document.querySelector(".days-between-dates"),this.$btnSubmit=document.querySelector(".main__btn-submit"),this.btnsSettings=document.querySelector(".main__settings"),this.$inputD=document.getElementById("dateStartD"),this.$inputM=document.getElementById("dateStartM"),this.$inputY=document.getElementById("dateStartY"),this.memoryInputsStart="",this.memoryInputsEnd="",this.trueMaxD,//! правильна к-сть днів в місяці якщо нам відомо міс. і р.
this.trueMaxDEnd,//! правильна к-сть днів в місяці якщо нам відомо міс. і р.
this.$inputEndD=document.getElementById("dateEndD"),this.$inputEndM=document.getElementById("dateEndM"),this.$inputEndY=document.getElementById("dateEndY"),this.currentEndD=this.formatDateTwoNum((new Date).getDate()),this.currentEndM=this.formatDateTwoNum((new Date).getMonth()+1),this.currentEndY=(new Date).getFullYear(),this.$inputEndD.placeholder=this.currentEndD,this.$inputEndM.placeholder=this.currentEndM,this.$inputEndY.placeholder=this.currentEndY,this.currentDate=`${this.currentEndD}.${this.currentEndM}.${this.currentEndY}`,this.$checkedFirstDay=document.querySelector('[data-input-setting="first-day"]'),this.$checkedLastDay=document.querySelector('[data-input-setting="last-day"]'),this.includingFirstDay=!1,this.includingLastDay=!1,this.isLoad=!1,window.addEventListener("load",(()=>{this.isLoad=!0})),this.resultDbdVisible=!1}changeplaceholderContent(t,e){e>=3&&e<=6&&(""!==t.value||""!==this.$inputEndD.value||""!==this.$inputEndM.value||""!==this.$inputEndY.value?(this.$inputEndD.placeholder="дд",this.$inputEndM.placeholder="мм",this.$inputEndY.placeholder="рррр"):""===this.$inputEndD.value&&""===this.$inputEndM.value&&""===this.$inputEndY.value&&(this.$inputEndD.placeholder=this.currentEndD,this.$inputEndM.placeholder=this.currentEndM,this.$inputEndY.placeholder=this.currentEndY))}validEventTargetInput(t,e){const a=t.value;2===e||5===e?(t.value=a.replace(/(.{4})./,"$1").replace(/[^\d]/g,""),this.$el[e].value.length>=4&&e+1<4&&this.$el[e+1].focus()):(t.value=a.replace(/(.{2})./,"$1").replace(/[^\d]/g,""),this.$el[e].value.length>=2&&this.$el[e+1].focus(),(0===e||3===e&&!0===this.isLoad&&""===this.$inputM.value&&""===this.$inputY.value)&&(Number(t.value)>31&&this.colorErrorInputOverDate(t,"31","red","black",e),"00"===t.value&&this.colorErrorInputOverDate(t,"01","red","black",e)),1!==e&&4!==e||("00"===t.value&&this.colorErrorInputOverDate(t,"01","red","black",e),Number(t.value)>12&&this.colorErrorInputOverDate(t,"12","red","black",e)))}autoRenameDayInYear(){if(2===this.$inputD.value.length&&2===this.$inputM.value.length&&4===this.$inputY.value.length||2===this.$inputEndD.value.length&&2===this.$inputEndM.value.length&&4===this.$inputEndY.value.length){Number(this.$inputD.value);const t=Number(this.$inputM.value),e=Number(this.$inputY.value),a=(Number(this.$inputEndD.value),Number(this.$inputEndM.value)),i=Number(this.$inputEndY.value),n=(t,e)=>{const a=[];for(let e=0;e<12;e++){const i=new Date(t,e+1,0).getDate();a.push(i)}return a[e]};if(""!==this.$inputM.value&&""!==this.$inputY.value){`${this.$inputM.value}${this.$inputY.value}`!==this.memoryInputsStart&&(this.memoryInputsStart=`${this.$inputM.value}${this.$inputY.value}`,this.trueMaxD=n(e,t-1))}else this.memoryInputsStart;this.memoryInputsEnd[0]===this.$inputEndM.value&&this.memoryInputsEnd[1]===this.$inputEndY.value||(this.memoryInputsEnd=[this.$inputEndM.value,this.$inputEndY.value],this.trueMaxDEnd=n(i,a-1)),Number(this.$inputD.value)>this.trueMaxD&&(this.$inputD.style.color="red",setTimeout((()=>{this.$inputD.value=this.trueMaxD,this.$inputD.style.color="green",localStorage.setItem("inputD",this.trueMaxD),setTimeout((()=>{this.$inputD.style.color="black"}),1e3)}),200)),Number(this.$inputEndD.value)>=this.trueMaxDEnd&&(this.$inputEndD.value=this.trueMaxDEnd,localStorage.setItem("inputEndD",this.$inputEndD.value))}}runSetItemLS(t,e){switch(t){case 0:localStorage.setItem("inputD",e);break;case 1:localStorage.setItem("inputM",e);break;case 2:localStorage.setItem("inputY",e);break;case 3:localStorage.setItem("inputEndD",e);break;case 4:localStorage.setItem("inputEndM",e);break;case 5:localStorage.setItem("inputEndY",e)}}ifRenderResultDbd(){document.querySelector(".result-render-dbd")?(this.resultDbdVisible=!0,localStorage.setItem("resultDbdVisible",this.resultDbdVisible)):(this.resultDbdVisible=!1,localStorage.setItem("resultDbdVisible",this.resultDbdVisible))}colorErrorInputOverDate(t,e,a,i,n){t.style.color=a,setTimeout((()=>{t.style.color="green",t.value=t.value.replace(/\d+/,e),this.runSetItemLS(n,t.value),setTimeout((()=>{t.style.color=i}),1e3)}),200)}inputsFocusKey(t,e){let a=0,i=0,n=0;const s=t.selectionStart;t.setSelectionRange(s,s),t.addEventListener("blur",(function(a){var i;switch((1===t.value.length&&0===e||1===e||3===e||4===e)&&(i="0",t.value=t.value.replace(/^(\d)$/,`${i}$1`)),2!==e&&5!==e||(Number(t.value)>=10&&Number(t.value)<=29&&2===t.value.length&&(t.value=t.value.replace(/^/,"20")),Number(t.value)>=30&&Number(t.value)<=99&&2===t.value.length&&(t.value=t.value.replace(/^/,"19"))),e){case 0:localStorage.setItem("inputD",a.target.value);break;case 1:localStorage.setItem("inputM",a.target.value);break;case 2:localStorage.setItem("inputY",a.target.value);break;case 3:localStorage.setItem("inputEndD",a.target.value);break;case 4:localStorage.setItem("inputEndM",a.target.value);break;case 5:localStorage.setItem("inputEndY",a.target.value)}})),t.addEventListener("keyup",(t=>{if(8===t.keyCode&&0===t.target.selectionStart){if(//! Backspace key
a+=1,e-1!=-1&&2===a){this.$el[e-1].focus();const t=this.$el[e-1].value.length;this.$el[e-1].setSelectionRange(t,t),a=0}}else a=0;if(13===t.keyCode&&(//! Enter key
t.target.blur(),window.addEventListener("unload",(function(){t.target.blur()})),this.$btnSubmit.click()),37===t.keyCode&&0===t.target.selectionStart){if(//! <- key
i+=1,n=0,e-1!=-1&&2===i){i=0,this.$el[e-1].focus();const t=this.$el[e-1].value.length;this.$el[e-1].setSelectionRange(t,t)}}else i=0;39===t.keyCode&&t.target.selectionStart===t.target.value.length?(//! -> key
n+=1,i=0,e-1!=4&&2===n&&(n=0,this.$el[e+1].focus(),this.$el[e+1].setSelectionRange(0,0))):n=0}))}escapeFromFocusInputUnload(){this.$el.forEach((t=>{window.addEventListener("unload",(()=>{t.blur()}))}))}eTargetClick(){document.addEventListener("click",(t=>t.target))}validEventTargetClick(t,e){const a=t.value;t.value=2===e||5===e?a.slice(0,4):a.slice(0,2)}setLoadLocalStorage(t,e){t.addEventListener("blur",(()=>{localStorage.setItem(e,t.value)})),t.addEventListener("input",(()=>{localStorage.setItem(e,t.value)})),window.addEventListener("load",(()=>{t.value=localStorage.getItem(e),a(".days-between-dates")}))}afterLocalStorageRun(){window.addEventListener("load",(()=>{!1!==this.dateStart()&&"true"===localStorage.getItem("resultDbdVisible")&&this.$btnSubmit.click()}))}loadLocalStorageCheackbox(t,e,a){window.addEventListener("load",(()=>{const a=localStorage.getItem(t);"false"===a&&(e.checked=!1,!1),"true"===a&&(e=!0,!0)}))}runLocalStorage(){return this.setLoadLocalStorage(this.$inputD,"inputD"),this.setLoadLocalStorage(this.$inputM,"inputM"),this.setLoadLocalStorage(this.$inputY,"inputY"),this.setLoadLocalStorage(this.$inputEndD,"inputEndD"),this.setLoadLocalStorage(this.$inputEndM,"inputEndM"),this.setLoadLocalStorage(this.$inputEndY,"inputEndY"),this.loadLocalStorageCheackbox("includingFirstDay",this.$checkedFirstDay,this.includingFirstDay),this.loadLocalStorageCheackbox("includingLastDay",this.$checkedLastDay,this.includingLastDay),this.afterLocalStorageRun(),this}localStorageClear(t){"start"===t?(localStorage.removeItem("inputD"),localStorage.removeItem("inputM"),localStorage.removeItem("inputY")):"end"===t&&(localStorage.removeItem("inputEndD"),localStorage.removeItem("inputEndM"),localStorage.removeItem("inputEndY"))}formatDateTwoNum(t){return 1===(t+="").length?"0"+t:Number(t)}dateStart(){return""!==this.$inputD.value&&""!==this.$inputM.value&&""!==this.$inputY.value&&2===this.$inputD.value.length&&2===this.$inputM.value.length&&4===this.$inputY.value.length&&`${this.$inputD.value}.${this.$inputM.value}.${this.$inputY.value}`}dateEnd(){if(!0===this.isLoad){if(""!==this.$inputEndD.value&&""!==this.$inputEndM.value&&""!==this.$inputEndY.value&&2===this.$inputEndD.value.length&&2===this.$inputEndM.value.length&&4===this.$inputEndY.value.length)return`${this.$inputEndD.value}.${this.$inputEndM.value}.${this.$inputEndY.value}`;if(""===this.$inputEndD.value&&""===this.$inputEndM.value&&""===this.$inputEndY.value)return"current";if(2!==this.$inputEndD.value.length||2!==this.$inputEndM.value.length||4!==this.$inputEndY.value.length)return"error"}}eventBtns(){const t=document.querySelectorAll(".btn");document.querySelector(".days-between-dates"),document.querySelector(".result-render-dbd");t.forEach((t=>{t.addEventListener("click",(t=>{t.target.closest('[data-btn="clear-start"]')?(this.$inputD.value="",this.$inputM.value="",this.$inputY.value="",this.localStorageClear("start"),this.ifRenderResultDbd()):t.target.closest('[data-btn="clear-end"]')?(this.$inputEndD.value="",this.$inputEndM.value="",this.$inputEndY.value="",this.$inputEndD.placeholder=this.currentEndD,this.$inputEndM.placeholder=this.currentEndM,this.$inputEndY.placeholder=this.currentEndY,this.localStorageClear("end"),this.ifRenderResultDbd()):t.target.closest('[data-btn="clear-result"]')&&(a(".days-between-dates"),this.resultDbdVisible=!1,localStorage.setItem("resultDbdVisible",this.resultDbdVisible))}))}))}setPlaceholder(t,e){const a=t.getAttribute("placeholder");t.getAttribute("placeholder")===a&&t.setAttribute("placeholder",""),t.addEventListener("blur",(()=>{""===t.getAttribute("placeholder")&&t.setAttribute("placeholder",a)}))}setChekbox(){const t="checked";!0!==this.$checkedFirstDay.checked&&"true"!==localStorage.getItem("includingFirstDay")||(this.$checkedFirstDay.parentNode.classList.add(t),this.includingFirstDay=!0),!1!==this.$checkedFirstDay.checked&&"false"!==localStorage.getItem("includingFirstDay")||(this.$checkedFirstDay.parentNode.classList.remove(t),this.includingFirstDay=!1),!0!==this.$checkedLastDay.checked&&"true"!==localStorage.getItem("includingLastDay")||(this.$checkedLastDay.parentNode.classList.add(t),this.includingLastDay=!0),!1!==this.$checkedLastDay.checked&&"false"!==localStorage.getItem("includingLastDay")||(this.$checkedLastDay.parentNode.classList.remove(t),this.includingLastDay=!1),this.btnsSettings.addEventListener("input",(e=>{const a=(a,i)=>{e.target.dataset.inputSetting===a&&(e.target.checked?(e.target.parentNode.classList.add(t),1===i&&(this.includingFirstDay=!0,localStorage.setItem("includingFirstDay",this.includingFirstDay)),2===i&&(this.includingLastDay=!0,localStorage.setItem("includingLastDay",this.includingLastDay))):(e.target.parentNode.classList.remove(t),1===i&&(this.includingFirstDay=!1,localStorage.setItem("includingFirstDay",this.includingFirstDay)),2===i&&(this.includingLastDay=!1,localStorage.setItem("includingLastDay",this.includingLastDay))))};a("first-day",1),a("last-day",2)}))}errorInpust(){let t=0;this.$el.forEach((e=>{t+=1;const n=(t,n)=>{e.classList.add("error-inputs"),a(".days-between-dates"),e.addEventListener("animationend",(()=>{e.classList.remove("error-inputs")})),"Error > 13M"===t&&i(".days-between-dates",{isError:!0,errorClassName:"error-result-dbd",errorMessage:"Кількість місяців у році не може перевищувати 12!"})};!0===this.isLoad&&((2===t&&Number(e.value)>12||5===t&&Number(e.value)>12)&&n("Error > 13M",e.value),!1===this.dateStart()&&(e.value.length<2&&t<=2||e.value.length<4&&3===t)&&//! errorInpust Start date
n(),"error"===this.dateEnd()&&(e.value.length<2&&t>=4&&t<=5||e.value.length<4&&6===t)&&//! errorInpust End date
n())}))}scrollToElem(){this.$btnSubmit.addEventListener("click",(()=>{const t=document.querySelector(".result-render-dbd");if(t){const e=t.offsetTop-30;window.scrollTo({top:e,behavior:"smooth"})}}))}}(".main__input");n.runLocalStorage(),n.eventBtns();for(let t=0;t<n.$el.length;t++){let e=n.$el[t];e.setAttribute("inputmode","numeric"),e.addEventListener("focus",(e=>{//! event FOCUS iInputs!!!==================
n.inputsFocusKey(e.target,t),n.autoRenameDayInYear(),n.changeplaceholderContent(e.target,t),n.setPlaceholder(e.target,t)})),e.addEventListener("input",(e=>{//! event INPUT iInputs!!!=================
n.validEventTargetInput(e.target,t),n.autoRenameDayInYear(),n.changeplaceholderContent(e.target,t)})),window.addEventListener("load",(()=>{//! event LOAD iInputs!!!=================
n.autoRenameDayInYear(),n.validEventTargetInput(e,t),n.changeplaceholderContent(e,t)}))}
//!====================================RIPPLE Button================================
function s(t,e){document.addEventListener("click",(function(a){const i=a.target;if(i.closest(`[data-${t}]`)){const n=i.closest(`[data-${t}]`),s=document.createElement("span"),r=Math.max(n.clientWidth,n.clientHeight),l=r/2;s.style.width=s.style.height=`${r}px`,s.style.left=a.pageX-(n.getBoundingClientRect().left+scrollX)-l+"px",s.style.top=a.pageY-(n.getBoundingClientRect().top+scrollY)-l+"px",s.classList.add(e),
//! Налаштування: якщо дописати в HTML data-ripple="once", то анімація не накладується!!!
n.dataset.ripple=n.querySelector(`.${e}`)?n.querySelector(`.${e}`).remove():null,n.appendChild(s);const u=d();function d(){const t=window.getComputedStyle(s).animationDuration;return t.includes("ms")?t.replace("ms",""):1e3*t.replace("s","")}setTimeout((()=>{s&&s.remove()}),u)}}))}n.setChekbox(),n.runLocalStorage(),n.$btnSubmit.addEventListener("click",(e=>{//! event CLICK btnSubmit!!!===========
n.errorInpust();for(let t=0;t<n.$el.length;t++){let e=n.$el[t];n.validEventTargetClick(e,t)}if(!1!==n.dateStart()&&n.$el[1].value<=12&&n.$el[4].value<=12){const e=new t(".days-between-dates",{startDate:n.dateStart(),endDate:n.dateEnd(),includingFirstDay:n.includingFirstDay,includingLastDay:n.includingLastDay});//!====
!1!==e.errorMessage()?i(".days-between-dates",{isError:!1,totalDays:e.totalDays(),starDate:n.dateStart(),endDate:n.dateEnd(),curentData:n.currentDate,years:e.calcYear,months:e.calcMonths,days:e.calcDays,includingFirstDay:n.includingFirstDay}):!1===e.errorMessage()&&"error"!==n.dateEnd()&&i(".days-between-dates",{isError:!0,errorClassName:"error-result-dbd",errorMessage:"Початкова дата більша за кінцеву дату!"})}n.ifRenderResultDbd(),n.scrollToElem()})),n.escapeFromFocusInputUnload(),s("ripple","ripple"),s("ripple-clear","ripple-clear"),s("input-ripple-clear","ripple-clear"),window.FLS=!0,function(t){let e=new Image;e.onload=e.onerror=function(){t(2==e.height)},e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(t){let e=!0===t?"webp":"no-webp";document.documentElement.classList.add(e)}))})();